# n8n - Workflow Automation Platform
# Self-hosted alternative to Zapier/Make with 400+ integrations
# https://n8n.io/

# =============================================================================
# Variables
# =============================================================================
[[config.variables]]
variable = "N8N_DOMAIN"
label = "Domain"
description = "Domain for n8n (e.g., n8n.example.com)"
required = true
type = "domain"

# =============================================================================
# Environment Variables
# =============================================================================
[config.env]
# ===========================================================================
# Instance Configuration
# ===========================================================================
# The domain is configured via the N8N_DOMAIN variable above
# Webhook URL will be https://${N8N_DOMAIN}/

# ===========================================================================
# Database Configuration
# ===========================================================================
# PostgreSQL database name
POSTGRES_DB = "n8n"

# PostgreSQL username
POSTGRES_USER = "n8n"

# PostgreSQL password (auto-generated)
POSTGRES_PASSWORD = "randomPassword()"

# ===========================================================================
# Security Configuration
# ===========================================================================
# Encryption key for credentials storage
# Critical: If you lose this key, all stored credentials become inaccessible
N8N_ENCRYPTION_KEY = "base64(32)"

# Task runner authentication token (n8n 2.0+ external runners)
# Secures communication between n8n and task runner containers
N8N_RUNNERS_AUTH_TOKEN = "randomPassword()"

# Basic auth for editor (disabled by default - use n8n's built-in user system)
N8N_BASIC_AUTH_ACTIVE = "false"
# N8N_BASIC_AUTH_USER = "admin"
# N8N_BASIC_AUTH_PASSWORD = "randomPassword()"

# ===========================================================================
# Timezone Configuration
# ===========================================================================
# Set your timezone for correct workflow scheduling
# Examples: UTC, America/New_York, Europe/London, Asia/Tokyo
TZ = "UTC"

# ===========================================================================
# Performance Configuration
# ===========================================================================
# Enable task runners for improved execution (n8n 1.60+)
N8N_RUNNERS_ENABLED = "true"

# Prune old execution data (recommended for storage management)
EXECUTIONS_DATA_PRUNE = "true"

# Keep execution data for N hours (default: 336 = 14 days)
EXECUTIONS_DATA_MAX_AGE = "336"

# ===========================================================================
# Email Configuration (Optional)
# ===========================================================================
# Configure SMTP for workflow notifications and user invitations
# N8N_EMAIL_MODE = "smtp"
# N8N_SMTP_HOST = "smtp.example.com"
# N8N_SMTP_PORT = "587"
# N8N_SMTP_USER = "your-smtp-user"
# N8N_SMTP_PASS = "your-smtp-password"
# N8N_SMTP_SENDER = "n8n@example.com"
# N8N_SMTP_SSL = "true"

# ===========================================================================
# External Storage - Cloudflare R2 (Optional)
# ===========================================================================
# Enable S3-compatible storage for binary data (files, images, etc.)
# Reduces Docker volume size and enables scalable storage
# Note: R2 is S3-compatible but not officially supported by n8n
#
# To enable R2 storage:
# 1. Create a Cloudflare R2 bucket
# 2. Generate R2 API tokens (Access Key ID and Secret Access Key)
# 3. Uncomment and configure the variables below
# 4. Set N8N_DEFAULT_BINARY_DATA_MODE to "s3"
#
# N8N_AVAILABLE_BINARY_DATA_MODES = "filesystem,s3"
# N8N_DEFAULT_BINARY_DATA_MODE = "s3"
#
# Cloudflare R2 endpoint format: https://<account_id>.r2.cloudflarestorage.com
# N8N_EXTERNAL_STORAGE_S3_HOST = "https://your-account-id.r2.cloudflarestorage.com"
# N8N_EXTERNAL_STORAGE_S3_BUCKET_NAME = "n8n-storage"
# N8N_EXTERNAL_STORAGE_S3_BUCKET_REGION = "auto"
# N8N_EXTERNAL_STORAGE_S3_ACCESS_KEY = "your-r2-access-key-id"
# N8N_EXTERNAL_STORAGE_S3_ACCESS_SECRET = "your-r2-secret-access-key"

# ===========================================================================
# First-Time Setup
# ===========================================================================
# After deployment:
# 1. Navigate to https://your-domain/
# 2. Create your first admin user account
# 3. Set up credentials for integrations you want to use
# 4. Import workflow templates or create your own
#
# Important Security Note:
# - N8N_ENCRYPTION_KEY is auto-generated and critical for credential storage
# - Back up this key! Losing it means losing access to all stored credentials
# - Consider storing it in a secure location outside Dokploy
