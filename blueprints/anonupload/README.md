# AnonUpload Dokploy Template

A privacy-focused, databaseless file sharing application for anonymous file uploads.

## Overview

[AnonUpload](https://github.com/supernova3339/anonupload) is a simple PHP file uploader built with privacy in mind. It doesn't show direct filenames and requires no database, making it lightweight and easy to deploy.

## Features

- **Anonymous Uploads**: No user accounts required for uploading
- **Privacy-Focused**: Obfuscated filenames protect uploader identity
- **Databaseless**: Simple file-based storage, no database setup needed
- **Admin Panel**: Manage uploads and configure settings
- **Configurable Limits**: Set allowed file types and size limits
- **Download Delays**: Optional countdown before download starts

## Services

| Service | Image | Port | Purpose |
|---------|-------|------|---------|
| anonupload | ghcr.io/supernova3339/anonfiles:1 | 80 | PHP/Apache web application |

## Quick Start

### Prerequisites

- Dokploy instance running
- Domain configured for the service
- SSL certificate (handled by Dokploy/Traefik)

### Deployment

1. In Dokploy, create a new **Compose** project
2. Select **Git** as source or paste the docker-compose.yml
3. Configure the environment variables (see below)
4. Deploy and access via your configured domain

## Configuration

### Required Variables

| Variable | Description | Example |
|----------|-------------|---------|
| `ANONUPLOAD_DOMAIN` | Your domain for the service | `anonupload.hashgrid.net` |
| `ADMIN_EMAIL` | Admin login email | `admin@hashgrid.net` |
| `ADMIN_PASSWORD` | Admin login password | Auto-generated by template |
| `APP_CONTACT_EMAIL` | Email for abuse reports | `abuse@hashgrid.net` |

### Optional Variables

| Variable | Default | Description |
|----------|---------|-------------|
| `APP_NAME` | AnonUpload - Secure File Sharing | Page title |
| `APP_DESC` | Privacy-focused anonymous file sharing | Meta description |
| `APP_FILELIST` | jpeg,jpg,gif,png,zip... | Comma-separated allowed extensions |
| `APP_SIZE_VERIFICATION` | true | Enable file size checks |
| `APP_MAX_SIZE` | 10000000000 | Max upload size in bytes (10 GB) |
| `APP_MIN_SIZE` | 0 | Min upload size in bytes |
| `APP_DOWNLOAD_TIME` | 30 | Seconds before download link activates |

### File Type Reference

Default allowed types:
```
jpeg, jpg, gif, png, zip, xls, xlsx, doc, docx, pdf, mp3, mp4, mpeg, wav, avi, rar, 7z, txt, tar, gz
```

To add more types, modify `APP_FILELIST` with comma-separated extensions.

### Size Limits

| Size | Bytes |
|------|-------|
| 1 GB | 1000000000 |
| 5 GB | 5000000000 |
| 10 GB | 10000000000 |
| 50 GB | 50000000000 |

## Volumes

| Volume | Mount Point | Purpose |
|--------|-------------|---------|
| anonupload-files | /var/www/html/files | Uploaded file storage |

## Network Architecture

```
Internet
    │
    ▼
┌─────────────┐
│   Traefik   │ (Dokploy reverse proxy)
│   :443      │
└─────────────┘
    │
    ▼
┌─────────────────────────────┐
│    dokploy-network          │
│    (external)               │
└─────────────────────────────┘
    │
    ▼
┌─────────────┐
│ AnonUpload  │
│    :80      │
└─────────────┘
```

## Admin Panel

Access the admin panel at:
```
https://your-domain.com/admin/
```

Login with your configured `ADMIN_EMAIL` and `ADMIN_PASSWORD`.

From the admin panel you can:
- View uploaded files
- Delete files
- See upload statistics

## Backup & Restore

### Backup

The only data to backup is the uploaded files volume:

```bash
# Create backup
docker run --rm -v anonupload-files:/data -v $(pwd):/backup alpine \
  tar czf /backup/anonupload-backup-$(date +%Y%m%d).tar.gz -C /data .
```

### Restore

```bash
# Restore from backup
docker run --rm -v anonupload-files:/data -v $(pwd):/backup alpine \
  sh -c "cd /data && tar xzf /backup/anonupload-backup-YYYYMMDD.tar.gz"
```

## Security Considerations

1. **Change Default Password**: Always set a strong `ADMIN_PASSWORD`
2. **Abuse Email**: Configure `APP_CONTACT_EMAIL` for DMCA/abuse reports
3. **File Types**: Restrict `APP_FILELIST` to only necessary types
4. **Size Limits**: Set appropriate `APP_MAX_SIZE` for your storage capacity
5. **SSL/TLS**: Ensure Dokploy/Traefik is configured for HTTPS

## Troubleshooting

### Container Won't Start

```bash
# Check logs
docker logs <container-id>

# Verify environment variables are set
docker inspect <container-id> | grep -A 50 "Env"
```

### Uploads Failing

1. Check `APP_MAX_SIZE` isn't exceeded
2. Verify file extension is in `APP_FILELIST`
3. Check volume permissions: files should be owned by www-data (uid 33)

### Health Check Failing

The health check verifies Apache is responding on port 80:
```bash
curl -f http://localhost:80/
```

If failing, check Apache error logs inside the container.

## Resources

- [AnonUpload GitHub](https://github.com/supernova3339/anonupload)
- [AnonUpload Environment Docs](https://github.com/supernova3339/anonupload/blob/main/env.md)
- [Dokploy Documentation](https://docs.dokploy.com/)

## License

AnonUpload is licensed under GPL-3.0. See the [original repository](https://github.com/supernova3339/anonupload) for details.
