# Grafana Observability Stack
# Full observability platform: Prometheus, Mimir, InfluxDB, Grafana, Promtail
# https://grafana.com/docs/

# =============================================================================
# Variables
# =============================================================================
[variables]
# Domain Configuration
grafana_domain = "${domain}"

# Grafana Credentials
grafana_admin_password = "${password:32}"
grafana_secret_key = "${base64:64}"

# InfluxDB Credentials
influxdb_admin_password = "${password:32}"
influxdb_admin_token = "${base64:48}"

# =============================================================================
# Domains
# =============================================================================
[[config.domains]]
serviceName = "grafana"
port = 3000
host = "${grafana_domain}"

# =============================================================================
# Environment Variables
# =============================================================================
[config.env]
# ===========================================================================
# Grafana Configuration
# ===========================================================================
GRAFANA_DOMAIN = "${grafana_domain}"
GRAFANA_ADMIN_USER = "admin"
GRAFANA_ADMIN_PASSWORD = "${grafana_admin_password}"
GRAFANA_SECRET_KEY = "${grafana_secret_key}"
GRAFANA_ANONYMOUS_ENABLED = "false"
GRAFANA_PLUGINS = "grafana-clock-panel,grafana-piechart-panel"

# ===========================================================================
# InfluxDB Configuration
# ===========================================================================
INFLUXDB_ADMIN_USER = "admin"
INFLUXDB_ADMIN_PASSWORD = "${influxdb_admin_password}"
INFLUXDB_ADMIN_TOKEN = "${influxdb_admin_token}"
INFLUXDB_ORG = "homelab"
INFLUXDB_BUCKET = "metrics"
INFLUXDB_RETENTION = "30d"
# INFLUXDB_CACHE_SIZE = "1073741824"      # 1GB cache (optional tuning)
# INFLUXDB_SNAPSHOT_SIZE = "26214400"     # 25MB snapshot (optional tuning)

# ===========================================================================
# Mimir Configuration (Long-term Storage)
# ===========================================================================
MIMIR_TENANT_ID = "anonymous"
# For Cloudflare R2 storage (optional - defaults to local filesystem):
# MIMIR_S3_ENDPOINT = "https://YOUR_ACCOUNT_ID.r2.cloudflarestorage.com"
# MIMIR_S3_ACCESS_KEY_ID = "your-access-key"
# MIMIR_S3_SECRET_ACCESS_KEY = "your-secret-key"
# MIMIR_S3_BUCKET = "mimir-blocks"

# ===========================================================================
# Prometheus Configuration
# ===========================================================================
PROMETHEUS_RETENTION = "15d"
PROMETHEUS_SCRAPE_INTERVAL = "15s"

# ===========================================================================
# Promtail / Grafana Cloud Logs (Optional)
# ===========================================================================
# Configure these to ship logs to Grafana Cloud Loki:
# LOKI_URL = "https://logs-prod-us-central1.grafana.net/loki/api/v1/push"
# LOKI_USERNAME = "your-grafana-cloud-user-id"
# LOKI_API_KEY = "your-grafana-cloud-api-key"
