services:
  # =============================================================================
  # dashdot - Modern Server Dashboard
  # https://github.com/MauriceNino/dashdot
  # =============================================================================
  dashdot:
    image: mauricenino/dashdot:v6.2.4
    restart: always
    privileged: true
    volumes:
      # Read-only mount of host filesystem for system metrics
      - /:/mnt/host:ro
      # Timezone configuration
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
    environment:
      # =======================================================================
      # Widget Configuration
      # Available: os, cpu, storage, ram, network, gpu
      # =======================================================================
      DASHDOT_WIDGET_LIST: ${DASHDOT_WIDGET_LIST:-os,cpu,storage,ram,network}
      # =======================================================================
      # Display Settings
      # =======================================================================
      DASHDOT_PAGE_TITLE: ${DASHDOT_PAGE_TITLE:-dash.}
      DASHDOT_USE_IMPERIAL: ${DASHDOT_USE_IMPERIAL:-false}
      DASHDOT_ALWAYS_SHOW_PERCENTAGES: ${DASHDOT_ALWAYS_SHOW_PERCENTAGES:-false}
      DASHDOT_SHOW_DASH_VERSION: ${DASHDOT_SHOW_DASH_VERSION:-icon_hover}
      # =======================================================================
      # Server Configuration
      # =======================================================================
      DASHDOT_PORT: "3001"
      DASHDOT_DISABLE_INTEGRATIONS: ${DASHDOT_DISABLE_INTEGRATIONS:-false}
      # =======================================================================
      # Timezone
      # =======================================================================
      TZ: ${TZ:-UTC}
    networks:
      - dashdot-net
      - dokploy-network
    labels:
      - "traefik.enable=true"
      # Main router for dashdot dashboard
      - "traefik.http.routers.dashdot.rule=Host(`${DOMAIN:?Set your domain}`)"
      - "traefik.http.routers.dashdot.entrypoints=websecure"
      - "traefik.http.routers.dashdot.tls.certresolver=letsencrypt"
      - "traefik.http.routers.dashdot.middlewares=dashdot-security@docker"
      # Security headers middleware
      - "traefik.http.middlewares.dashdot-security.headers.stsSeconds=31536000"
      - "traefik.http.middlewares.dashdot-security.headers.stsIncludeSubdomains=true"
      - "traefik.http.middlewares.dashdot-security.headers.contentTypeNosniff=true"
      - "traefik.http.middlewares.dashdot-security.headers.browserXssFilter=true"
      - "traefik.http.middlewares.dashdot-security.headers.referrerPolicy=strict-origin-when-cross-origin"
      - "traefik.http.services.dashdot.loadbalancer.server.port=3001"
      - "traefik.docker.network=dokploy-network"
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:3001/"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 15s

# =============================================================================
# Networks
# =============================================================================
networks:
  dashdot-net:
    driver: bridge
  dokploy-network:
    external: true
