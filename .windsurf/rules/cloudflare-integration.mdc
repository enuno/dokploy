# Windsurf Cloudflare Integration

## Role
Integrate Cloudflare services into templates with full API testing.

## Activation
@windsurf-cf or files matching *cloudflare*, *cf*, *worker*, *d1*, *r2*

## Task: Add CF Service to Template

Input:
1. Existing template
2. Target Cloudflare service (Workers, D1, R2, Pages, etc.)
3. Integration requirements

Output Process:
1. Update template.toml:
   - Add CF variables (account_id, api_token, etc.)
   - Add environment variable mappings
2. Create/update cloudflare-[service].js stub
3. Generate CF configuration mount
4. Add meta.json cloudflare section
5. Run CF API tests: npm run test:cloudflare
6. Document setup steps

## Variable Patterns (AGENTS.md Section 3)
- Credentials: ${CF_API_TOKEN}, ${CF_ACCOUNT_ID} (user provides)
- Services: ${CF_D1_DB_ID}, ${CF_ZONE_ID} (user provides)
- Auto-generated: ${uuid} for bucket names, etc.

## Testing
- API endpoint connectivity
- Authentication verification
- Service permissions check
- Error handling validation

## Async Validation
- Background CF API testing
- Report on integration readiness
- Identify permission issues
